# react-hooks-fetch

[![CI](https://img.shields.io/github/workflow/status/dai-shi/react-hooks-fetch/CI)](https://github.com/dai-shi/react-hooks-fetch/actions?query=workflow%3ACI)
[![npm](https://img.shields.io/npm/v/react-hooks-fetch)](https://www.npmjs.com/package/react-hooks-fetch)
[![size](https://img.shields.io/bundlephobia/minzip/react-hooks-fetch)](https://bundlephobia.com/result?p=react-hooks-fetch)
[![discord](https://img.shields.io/discord/627656437971288081)](https://discord.gg/MrQdmzd)

æ”¯æŒ React Suspense çš„è½»é‡æ•°æ®è¯·æ±‚åº“

## ä»‹ç»

è¯¥åº“ä¸ºä»»ä½•å¼‚æ­¥å‡½æ•°æä¾› React `useFetch`  hookï¼Œå®ƒåˆ©ç”¨ React Suspense å¹¶ä¸”å¿…é¡»ä¼˜å…ˆä½¿ç”¨ `createFetch` åˆ›å»º storeã€‚è¯¥ API è¢«è®¾è®¡ç”¨äºåœ¨æ¸²æŸ“å‰å¼ºåˆ¶è¯·æ±‚æ•°æ®ã€‚

é¡¹ç›®çŠ¶æ€ï¼šè¯•éªŒæ€§ ğŸ§ªã€‚ æˆ‘ä»¬éœ€è¦æ”¶é›†åé¦ˆã€‚

## å®‰è£…

```bash
npm install react-hooks-fetch
```

## ä½¿ç”¨

```javascript
import React, { Suspense } from 'react';
import { ErrorBoundary } from 'react-error-boundary';

import { createFetch, useFetch } from 'react-hooks-fetch';

// 1ï¸âƒ£
// ä½¿ç”¨å¼‚æ­¥å‡½æ•°åˆ›å»ºä¸€ä¸ª storeã€‚
// è¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ª inputï¼ˆuserIdï¼‰ å‚æ•°ã€‚
// è¯¥å‚æ•°ä½œä¸ºç¼“å­˜çš„ "key"ã€‚
// é»˜è®¤æƒ…å†µä¸‹, ç¼“å­˜çš„ key çš„æ¯”è¾ƒä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰ `===`ã€‚
const store = createFetch(async (userId) => {
  const res = await fetch(`https://reqres.in/api/users/${userId}?delay=3`);
  const data = await res.json();
  return data;
});

// 2ï¸âƒ£
// æˆ‘ä»¬éœ€è¦åœ¨æ¸²æŸ“å‰å¼€å§‹è¯·æ±‚ã€‚
// å¦‚æœåˆæ¬¡æ¸²æŸ“å…è®¸ `undefined` å€¼ï¼Œå¯ä»¥è·³è¿‡ã€‚
store.prefetch('1');

// 3ï¸âƒ£
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ storeã€‚
// `refetch` æ–¹æ³•æ¥å—ä¸€ä¸ª input å‚æ•°ï¼Œç„¶ååœ¨æ¸²æŸ“å‰å¼€å§‹è¯·æ±‚ã€‚
const Main = () => {
  const { result, refetch } = useFetch(store, '1');
  const handleClick = () => {
    refetch('2');
  };
  return (
    <div>
      <div>First Name: {result.data.first_name}</div>
      <button type='button' onClick={handleClick}>
        Fetch user 2
      </button>
    </div>
  );
};

// 4ï¸âƒ£
// å¤–å±‚ç»„ä»¶éœ€è¦ ErrorBoundary å’Œ Suspense boundaryã€‚
const App = () => (
  <ErrorBoundary fallback={<h1>Error</h1>}>
    <Suspense fallback={<span>Loading...</span>}>
      <Main />
    </Suspense>
  </ErrorBoundary>
);
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### createFetch

åˆ›å»º fetch store

#### å‚æ•°

- `fetchFunc` **FetchFunc\<Input, Result>**
- `options` **Options\<Input, Result>?**

#### ä¾‹å­

```javascript
import { createFetch } from 'react-hooks-fetch';

const fetchFunc = async (userId) => {
  const res = await fetch(`https://reqres.in/api/users/${userId}?delay=3`));
  const data = await res.json();
  return data;
};
const store = createFetch(fetchFunc);
store.prefetch('1');
```

### useFetch

useFetch hook

#### å‚æ•°

- `store` **FetchStore\<Input, Result>**
- `initialInput` **Input?**

#### ä¾‹å­

```javascript
import { useFetch } from 'react-hooks-fetch';

const { result, refetch } = useFetch(store, initialInput);
```

## ä¾‹å­

[ç”¨ä¾‹](examples) æ–‡ä»¶å¤¹ä¸‹åŒ…å«æ‰€æœ‰ç”¨ä¾‹ï¼Œä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿è¡Œ

```bash
PORT=8080 npm run examples:01_minimal
```
ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <http://localhost:8080>ã€‚

ä½ ä¹Ÿå¯ä»¥åœ¨ codesandbox.io å°è¯•åœ¨çº¿ç”¨ä¾‹ï¼š
[01](https://codesandbox.io/s/github/dai-shi/react-hooks-fetch/tree/main/examples/01_minimal)
[02](https://codesandbox.io/s/github/dai-shi/react-hooks-fetch/tree/main/examples/02_typescript)
[03](https://codesandbox.io/s/github/dai-shi/react-hooks-fetch/tree/main/examples/03_noinit)

## åšå®¢
ä¹‹å‰çš„å®ç°ï¼Œè¯·æŸ¥çœ‹[å†å²](./HISTORY.md)ã€‚

- [React Hooks Tutorial on Developing a Custom Hook for Data Fetching](https://blog.axlight.com/posts/react-hooks-tutorial-on-developing-a-custom-hook-for-data-fetching/)
- [useFetch: React custom hook for Fetch API with Suspense and Concurrent Mode in Mind](https://blog.axlight.com/posts/usefetch-react-custom-hook-for-fetch-api-with-suspense-and-concurrent-mode-in-mind/)
- [Developing a React Library for Suspense for Data Fetching in Concurrent Mode](https://blog.axlight.com/posts/developing-a-react-library-for-suspense-for-data-fetching-in-concurrent-mode/)
- [Diving Into React Suspense Render-as-You-Fetch for REST APIs](https://blog.axlight.com/posts/diving-into-react-suspense-render-as-you-fetch-for-rest-apis/)
